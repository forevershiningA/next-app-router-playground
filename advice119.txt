The issue is a Z-depth collision.

You are using bevelEnabled: true with a bevelThickness of 0.02.

The headstone face sits at roughly thickness / 2 + bevelThickness = ~0.195.

Your text was positioned at thickness / 2 + 0.01 = 0.185.

Result: The text is physically inside the stone behind the front bevel.

Here is the fixed code. I have adjusted the textZ calculation to account for the bevel, and I removed the custom font path (/fonts/Garamond.ttf) temporarily to ensure it renders (it will default to a standard sans-serif). If you have the font file in your public folder, you can add the prop back.

code
Tsx
download
content_copy
expand_less
--- START OF FILE HeroCanvas.tsx ---

'use client';

import React, { useMemo, useRef } from 'react';
import { Canvas, useFrame } from '@react-three/fiber';
import { 
  OrbitControls, 
  Environment, 
  PerspectiveCamera,
  ContactShadows,
  useTexture,
  Text
} from '@react-three/drei';
import * as THREE from 'three';

// --- Constants ---
const STONE_WIDTH = 2.3;
const STONE_HEIGHT = 2.5;
const STONE_THICKNESS = 0.35;
const SHOULDER_HEIGHT = 2.05;
const BASE_HEIGHT = 0.46;
const BASE_EXTRA_WIDTH = 0.58;
const BEVEL_SIZE = 0.02; // Defined constant for calculation

// --- Materials & Components ---

const GraniteMaterial = () => {
  const texture = useTexture('/textures/forever/l/Glory-Black-2.webp');
  
  useMemo(() => {
    if (texture) {
      texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
      texture.repeat.set(2, 2);
      texture.anisotropy = 16; 
    }
  }, [texture]);
  
  return (
    <meshStandardMaterial
      color="#1a1a1a"
      map={texture}
      roughness={0.08}
      metalness={0.1}
      envMapIntensity={1.5}
    />
  );
};

interface GoldTextProps {
  text: string;
  position: [number, number, number];
  fontSize: number;
  font?: string;
  fontWeight?: number | string;
}

const GoldText: React.FC<GoldTextProps> = ({ text, position, fontSize, font, fontWeight = 'normal' }) => {
  return (
    <Text
      position={position}
      fontSize={fontSize}
      // font={font} // Commented out to prevent 404 if file is missing. Uncomment if you have the file.
      anchorX="center"
      anchorY="middle"
      letterSpacing={0.02}
      lineHeight={1.2}
      fontWeight={fontWeight}
      outlineWidth={0.005}
      outlineColor="#000000"
      renderOrder={10} // Force it to render on top
    >
      {text}
      <meshStandardMaterial
        color="#fcc200"
        emissive="#d4af37"
        emissiveIntensity={0.3}
        roughness={0.2}
        metalness={0.9}
        toneMapped={false}
      />
    </Text>
  );
};

// --- Geometry Components ---

interface HeadstoneProps {
  width: number;
  height: number;
  thickness: number;
}

const SerpentineHeadstone: React.FC<HeadstoneProps> = ({ width, height, thickness }) => {
  const shape = useMemo(() => {
    const s = new THREE.Shape();
    const w2 = width / 2;
    s.moveTo(-w2, 0);
    s.lineTo(-w2, SHOULDER_HEIGHT);
    s.bezierCurveTo(-w2, height, -w2 / 3, height, 0, height * 0.95);
    s.bezierCurveTo(w2 / 3, height, w2, height, w2, SHOULDER_HEIGHT);
    s.lineTo(w2, 0);
    s.lineTo(-w2, 0);
    return s;
  }, [width, height]);

  const extrudeSettings = useMemo(() => ({
    depth: thickness,
    bevelEnabled: true,
    bevelSegments: 5,
    bevelSize: BEVEL_SIZE,
    bevelThickness: BEVEL_SIZE,
  }), [thickness]);

  return (
    <group position={[0, BASE_HEIGHT, 0]}>
      {/* 
        Center the mesh: 
        ExtrudeGeometry starts at Z=0 and goes to Z=depth.
        We shift it back by half thickness so the center is at 0.
      */}
      <mesh position={[0, 0, -thickness / 2]} castShadow receiveShadow>
        <extrudeGeometry args={[shape, extrudeSettings]} />
        <GraniteMaterial />
      </mesh>
    </group>
  );
};

const Base: React.FC<{ stoneWidth: number }> = ({ stoneWidth }) => {
  const width = stoneWidth + BASE_EXTRA_WIDTH;
  const depth = STONE_THICKNESS + 0.3;

  return (
    <mesh position={[0, BASE_HEIGHT / 2, 0]} castShadow receiveShadow>
      <boxGeometry args={[width, BASE_HEIGHT, depth]} />
      <GraniteMaterial />
    </mesh>
  );
};

// --- Scene Setup ---

interface HeroCanvasProps {
  rotation?: number;
}

const SceneContent = ({ targetRotation }: { targetRotation: number }) => {
  const groupRef = useRef<THREE.Group>(null);
  
  // FIX: Position Z Calculation
  // Thickness/2 (Front Face) + Bevel Thickness + Gap
  const textZ = (STONE_THICKNESS / 2) + BEVEL_SIZE + 0.02; 

  useFrame((state, delta) => {
    if (groupRef.current) {
      const step = 0.1;
      const diff = targetRotation - groupRef.current.rotation.y;
      if (Math.abs(diff) > 0.001) {
        groupRef.current.rotation.y += diff * step;
      }
      groupRef.current.rotation.y += Math.sin(state.clock.elapsedTime * 0.5) * 0.0005;
    }
  });

  return (
    <>
      <group ref={groupRef} position={[0, -1.4, 0]}>
        <SerpentineHeadstone width={STONE_WIDTH} height={STONE_HEIGHT} thickness={STONE_THICKNESS} />
        <Base stoneWidth={STONE_WIDTH} />
        
        <group position={[0, 0, 0]}>
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.60, textZ]}
            fontSize={0.11}
            text="In Loving Memory"
          />
          
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.50, textZ]}
            fontSize={0.22}
            text="Eleanor Rose"
            fontWeight="bold"
          />
          
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.40, textZ]}
            fontSize={0.11}
            text="☼ 1945   ✟ 2023"
          />
        </group>
      </group>
      
      <ContactShadows 
        position={[0, -1.39, 0]}
        opacity={0.6} 
        scale={10} 
        blur={2} 
        far={2} 
        resolution={256} 
        color="#000000" 
      />
    </>
  );
};

// --- Main Component ---

export default function HeroCanvas({ rotation = 0 }: HeroCanvasProps) {
  return (
    <div style={{ width: '100%', height: '100%', minHeight: '400px', margin: '0 auto' }}>
      <Canvas 
        key="hero-canvas"
        shadows 
        dpr={[1, 2]}
        gl={{ 
          alpha: true, 
          antialias: true,
          toneMapping: THREE.ACESFilmicToneMapping,
          toneMappingExposure: 1.1
        }} 
        style={{ background: 'transparent' }}
      >
        <React.Suspense fallback={null}>
          <PerspectiveCamera makeDefault position={[2, 1.3, 3.5]} fov={45} />
          
          <ambientLight intensity={0.5} />
          
          <spotLight 
            position={[5, 5, 5]} 
            angle={0.5} 
            penumbra={1} 
            intensity={1.5} 
            castShadow
            shadow-bias={-0.0001}
            color="#fff0d0" 
          />
          
          <pointLight position={[-3, 2, 4]} intensity={0.5} color="#dbeaff" />
          <pointLight position={[-2, 4, -5]} intensity={1} color="#ffffff" />
          
          {/* Main text illumination */}
          <pointLight position={[0, 1, 3]} intensity={0.8} color="#ffd700" distance={6} />

          <Environment preset="city" />

          <SceneContent targetRotation={rotation} />

          <OrbitControls
            enablePan={false}
            enableZoom={false}
            minPolarAngle={0} 
            maxPolarAngle={Math.PI / 2 - 0.05} 
            enableDamping={true}
            dampingFactor={0.05}
          />
        </React.Suspense>
      </Canvas>
    </div>
  );
}