Here is the optimized HeroCanvas.tsx.

Key Optimizations:

Removed Fixed Height: Removed minHeight: '500px' from the wrapper. This allows the canvas to respect the responsive height defined in the parent HomeSplash component (h-[380px], etc.), preventing layout shifts and scrolling issues on mobile.

Responsive Camera Position: Adjusted the camera position to [0, 1.5, 5.5]. This centered, slightly further-back view ensures the full width of the headstone (especially the base) fits within the narrow viewports of mobile devices without being cut off.

Adjusted Lighting: Tweaked the lighting positions and intensities to prevent "glare" from obscuring the text on smaller screens and to ensure the gold text pops against the black stone.

Scene Positioning: Lowered the group Y position slightly (-1.6) to center the visual mass of the stone in the new responsive container height.

code
Tsx
download
content_copy
expand_less
'use client';

import React, { useMemo, useRef } from 'react';
import { Canvas, useFrame, useThree } from '@react-three/fiber';
import { 
  OrbitControls, 
  Environment, 
  PerspectiveCamera,
  ContactShadows,
  useTexture,
  Text
} from '@react-three/drei';
import * as THREE from 'three';

// --- Constants ---
const STONE_WIDTH = 2.3;
const STONE_HEIGHT = 2.5;
const STONE_THICKNESS = 0.35;
const SHOULDER_HEIGHT = 2.05;
const BASE_HEIGHT = 0.46;
const BASE_EXTRA_WIDTH = 0.58;
const BEVEL_SIZE = 0.02;

// --- Materials & Components ---

const GraniteMaterial = () => {
  const texture = useTexture('/textures/forever/l/Glory-Black-2.webp');
  
  useMemo(() => {
    if (texture) {
      texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
      texture.repeat.set(2, 2);
      texture.anisotropy = 16; 
    }
  }, [texture]);
  
  return (
    <meshStandardMaterial
      color="#1a1a1a"
      map={texture}
      roughness={0.08}
      metalness={0.1}
      envMapIntensity={1.5}
    />
  );
};

interface GoldTextProps {
  text: string;
  position: [number, number, number];
  fontSize: number;
  font?: string;
  fontWeight?: number | string;
}

const GoldText: React.FC<GoldTextProps> = ({ text, position, fontSize, font, fontWeight = 'normal' }) => {
  return (
    <Text
      position={position}
      fontSize={fontSize}
      font={font}
      anchorX="center"
      anchorY="middle"
      letterSpacing={0.02}
      lineHeight={1.2}
      fontWeight={fontWeight}
      characters="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{};':,./<>? "
      outlineWidth={0.005}
      outlineColor="#000000"
      renderOrder={10}
    >
      {text}
      <meshStandardMaterial
        color="#fcc200"
        emissive="#d4af37"
        emissiveIntensity={0.3}
        roughness={0.2}
        metalness={0.9}
        toneMapped={false}
      />
    </Text>
  );
};

// --- Geometry Components ---

interface HeadstoneProps {
  width: number;
  height: number;
  thickness: number;
}

const SerpentineHeadstone: React.FC<HeadstoneProps> = ({ width, height, thickness }) => {
  const shape = useMemo(() => {
    const s = new THREE.Shape();
    const w2 = width / 2;
    s.moveTo(-w2, 0);
    s.lineTo(-w2, SHOULDER_HEIGHT);
    
    // Serpentine Curve
    s.bezierCurveTo(-w2, height, -w2 / 3, height, 0, height * 0.95);
    s.bezierCurveTo(w2 / 3, height, w2, height, w2, SHOULDER_HEIGHT);

    s.lineTo(w2, 0);
    s.lineTo(-w2, 0);
    return s;
  }, [width, height]);

  const extrudeSettings = useMemo(() => ({
    depth: thickness,
    bevelEnabled: true,
    bevelSegments: 5,
    bevelSize: BEVEL_SIZE,
    bevelThickness: BEVEL_SIZE,
  }), [thickness]);

  return (
    <group position={[0, BASE_HEIGHT, 0]}>
      <mesh position={[0, 0, -thickness / 2]} castShadow receiveShadow>
        <extrudeGeometry args={[shape, extrudeSettings]} />
        <GraniteMaterial />
      </mesh>
    </group>
  );
};

const Base: React.FC<{ stoneWidth: number }> = ({ stoneWidth }) => {
  const width = stoneWidth + BASE_EXTRA_WIDTH;
  const depth = STONE_THICKNESS + 0.3;

  return (
    <mesh position={[0, BASE_HEIGHT / 2, 0]} castShadow receiveShadow>
      <boxGeometry args={[width, BASE_HEIGHT, depth]} />
      <GraniteMaterial />
    </mesh>
  );
};

// --- Scene Setup ---

interface HeroCanvasProps {
  rotation?: number;
}

const SceneContent = ({ targetRotation }: { targetRotation: number }) => {
  const groupRef = useRef<THREE.Group>(null);
  
  // FIX: Position Z Calculation
  const textZ = (STONE_THICKNESS / 2) + BEVEL_SIZE + 0.02;

  useFrame((state, delta) => {
    if (groupRef.current) {
      // Smooth interpolation for user rotation
      const step = 0.1;
      const diff = targetRotation - groupRef.current.rotation.y;
      
      if (Math.abs(diff) > 0.001) {
        groupRef.current.rotation.y += diff * step;
      }
      
      // Gentle idle drift
      groupRef.current.rotation.y += Math.sin(state.clock.elapsedTime * 0.5) * 0.0005;
    }
  });

  return (
    <>
      {/* Lowered Y position slightly to fit better in responsive container */}
      <group ref={groupRef} position={[0, -1.6, 0]}>
        <SerpentineHeadstone width={STONE_WIDTH} height={STONE_HEIGHT} thickness={STONE_THICKNESS} />
        <Base stoneWidth={STONE_WIDTH} />
        
        <group position={[0, 0, 0]}>
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.60, textZ]}
            fontSize={0.11}
            text="In Loving Memory"
            font="/fonts/Garamond.ttf"
          />
          
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.50, textZ]}
            fontSize={0.22}
            text="Eleanor Rose"
            font="/fonts/Garamond.ttf"
            fontWeight="bold"
          />
          
          <GoldText
            position={[0, BASE_HEIGHT + STONE_HEIGHT * 0.40, textZ]}
            fontSize={0.11}
            text="☼ 1945   ✟ 2023"
            font="/fonts/Garamond.ttf"
          />
        </group>
      </group>
      
      <ContactShadows 
        position={[0, -1.59, 0]}
        opacity={0.6} 
        scale={10} 
        blur={2} 
        far={2} 
        resolution={256} 
        color="#000000" 
      />
    </>
  );
};

// --- Main Component ---

export default function HeroCanvas({ rotation = 0 }: HeroCanvasProps) {
  return (
    // FIX: Removed fixed minHeight to respect parent responsive container (380px/500px)
    <div style={{ width: '100%', height: '100%', margin: '0 auto' }}>
      <Canvas
        key="hero-canvas"
        shadows 
        dpr={[1, 2]}
        gl={{ 
          alpha: true, 
          antialias: true,
          toneMapping: THREE.ACESFilmicToneMapping,
          toneMappingExposure: 1.1
        }} 
        style={{ background: 'transparent' }}
      >
        <React.Suspense fallback={null}>
          {/* FIX: Moved camera back (z: 5.5) and centered (x: 0) to prevent cutting off the base on narrow mobile screens */}
          <PerspectiveCamera makeDefault position={[0, 1.5, 5.5]} fov={45} />
          
          <ambientLight intensity={0.5} />
          
          {/* Main Key Light - Positioned to minimize harsh glare on the text face */}
          <spotLight 
            position={[8, 8, 8]} 
            angle={0.5} 
            penumbra={1} 
            intensity={1.2} 
            castShadow
            shadow-bias={-0.0001}
            color="#fff0d0" 
          />
          
          <pointLight position={[-3, 2, 4]} intensity={0.5} color="#dbeaff" />
          <pointLight position={[-2, 4, -5]} intensity={1} color="#ffffff" />
          
          {/* Text Highlight Light */}
          <pointLight position={[0, 1, 3]} intensity={0.8} color="#ffd700" distance={6} />

          <Environment preset="city" />

          <SceneContent targetRotation={rotation} />

          <OrbitControls
            enablePan={false}
            enableZoom={false}
            minPolarAngle={0} 
            maxPolarAngle={Math.PI / 2 - 0.05} 
            enableDamping={true}
            dampingFactor={0.05}
          />
        </React.Suspense>
      </Canvas>
    </div>
  );
}